{"ast":null,"code":"import _classCallCheck from\"/Users/r-maria/Desktop/dev/react-mesto-auth/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/r-maria/Desktop/dev/react-mesto-auth/node_modules/@babel/runtime/helpers/esm/createClass.js\";var Auth=/*#__PURE__*/function(){function Auth(_ref){var baseUrl=_ref.baseUrl;_classCallCheck(this,Auth);this._baseUrl=baseUrl;}//проверка корректности ответа, вызывать при каждом запросе\n_createClass(Auth,[{key:\"_handleResponse\",value:function _handleResponse(res){if(res.ok){return res.json();}return Promise.reject(res.status);}},{key:\"register\",value:function register(email,password){var _this=this;return fetch(\"\".concat(this._baseUrl,\"/signup\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})}).then(function(res){return _this._handleResponse(res);});}},{key:\"authorize\",value:function authorize(email,password){var _this2=this;return fetch(\"\".concat(this._baseUrl,\"/signin\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})}).then(function(res){return _this2._handleResponse(res);}).then(function(data){if(data!=null&&data.token){localStorage.setItem('token',data.token);return true;}});}//запрос для проверки валидности токена и получения email для вставки в шапку сайта\n},{key:\"checkToken\",value:function checkToken(token){var _this3=this;return fetch(\"\".concat(this._baseUrl,\"/users/me\"),{method:'GET',headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(token)}}).then(function(res){return _this3._handleResponse(res);});}}]);return Auth;}();export var auth=new Auth({baseUrl:'https://auth.nomoreparties.co'});","map":{"version":3,"names":["Auth","_ref","baseUrl","_classCallCheck","_baseUrl","_createClass","key","value","_handleResponse","res","ok","json","Promise","reject","status","register","email","password","_this","fetch","concat","method","headers","body","JSON","stringify","then","authorize","_this2","data","token","localStorage","setItem","checkToken","_this3","auth"],"sources":["/Users/r-maria/Desktop/dev/react-mesto-auth/src/utils/Auth.js"],"sourcesContent":["class Auth {\n    constructor({ baseUrl }) {\n        this._baseUrl = baseUrl;\n    }\n\n    //проверка корректности ответа, вызывать при каждом запросе\n    _handleResponse (res) {\n        if (res.ok) {\n            return res.json()\n        }\n        return Promise.reject(res.status)\n    }\n\n    register( email, password ) {\n        return fetch(`${this._baseUrl}/signup`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ email, password })\n        })\n            .then(res => this._handleResponse(res))\n    }\n\n    authorize( email, password ) {\n        return fetch(`${this._baseUrl}/signin`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ email, password })\n        })\n            .then(res => this._handleResponse(res))\n            .then((data) => {\n                if (data != null && data.token) {\n                    localStorage.setItem('token', data.token);\n                    return true;\n                }\n            })\n    }\n\n    //запрос для проверки валидности токена и получения email для вставки в шапку сайта\n    checkToken(token) {\n        return fetch(`${this._baseUrl}/users/me`, {\n            method: 'GET',\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\" : `Bearer ${token}`\n            }\n        })\n            .then(res => this._handleResponse(res))\n    }\n}\n\nexport const auth = new Auth ({\n    baseUrl: 'https://auth.nomoreparties.co'\n})\n"],"mappings":"mQAAM,CAAAA,IAAI,yBACN,SAAAA,KAAAC,IAAA,CAAyB,IAAX,CAAAC,OAAO,CAAAD,IAAA,CAAPC,OAAO,CAAAC,eAAA,MAAAH,IAAA,EACjB,IAAI,CAACI,QAAQ,CAAGF,OAAO,CAC3B,CAEA;AAAAG,YAAA,CAAAL,IAAA,GAAAM,GAAA,mBAAAC,KAAA,CACA,SAAAC,gBAAiBC,GAAG,CAAE,CAClB,GAAIA,GAAG,CAACC,EAAE,CAAE,CACR,MAAO,CAAAD,GAAG,CAACE,IAAI,CAAC,CAAC,CACrB,CACA,MAAO,CAAAC,OAAO,CAACC,MAAM,CAACJ,GAAG,CAACK,MAAM,CAAC,CACrC,CAAC,GAAAR,GAAA,YAAAC,KAAA,CAED,SAAAQ,SAAUC,KAAK,CAAEC,QAAQ,CAAG,KAAAC,KAAA,MACxB,MAAO,CAAAC,KAAK,IAAAC,MAAA,CAAI,IAAI,CAAChB,QAAQ,YAAW,CACpCiB,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAET,KAAK,CAALA,KAAK,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAC5C,CAAC,CAAC,CACGS,IAAI,CAAC,SAAAjB,GAAG,QAAI,CAAAS,KAAI,CAACV,eAAe,CAACC,GAAG,CAAC,GAAC,CAC/C,CAAC,GAAAH,GAAA,aAAAC,KAAA,CAED,SAAAoB,UAAWX,KAAK,CAAEC,QAAQ,CAAG,KAAAW,MAAA,MACzB,MAAO,CAAAT,KAAK,IAAAC,MAAA,CAAI,IAAI,CAAChB,QAAQ,YAAW,CACpCiB,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAET,KAAK,CAALA,KAAK,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAC5C,CAAC,CAAC,CACGS,IAAI,CAAC,SAAAjB,GAAG,QAAI,CAAAmB,MAAI,CAACpB,eAAe,CAACC,GAAG,CAAC,GAAC,CACtCiB,IAAI,CAAC,SAACG,IAAI,CAAK,CACZ,GAAIA,IAAI,EAAI,IAAI,EAAIA,IAAI,CAACC,KAAK,CAAE,CAC5BC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEH,IAAI,CAACC,KAAK,CAAC,CACzC,MAAO,KAAI,CACf,CACJ,CAAC,CAAC,CACV,CAEA;AAAA,GAAAxB,GAAA,cAAAC,KAAA,CACA,SAAA0B,WAAWH,KAAK,CAAE,KAAAI,MAAA,MACd,MAAO,CAAAf,KAAK,IAAAC,MAAA,CAAI,IAAI,CAAChB,QAAQ,cAAa,CACtCiB,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACL,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAF,MAAA,CAAaU,KAAK,CACrC,CACJ,CAAC,CAAC,CACGJ,IAAI,CAAC,SAAAjB,GAAG,QAAI,CAAAyB,MAAI,CAAC1B,eAAe,CAACC,GAAG,CAAC,GAAC,CAC/C,CAAC,WAAAT,IAAA,KAGL,MAAO,IAAM,CAAAmC,IAAI,CAAG,GAAI,CAAAnC,IAAI,CAAE,CAC1BE,OAAO,CAAE,+BACb,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}